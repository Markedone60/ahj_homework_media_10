!function(){"use strict";function e(e){return e<10?`0${e}`:e}const t=new class{constructor(){this.messages=document.querySelector(".messenger"),this.coords=null}async newMessage(e){if(this.coords=await function(){let e="";return navigator.geolocation?new Promise((t=>{navigator.geolocation.getCurrentPosition((n=>{const{latitude:s,longitude:o}=n.coords;e=`${s}, ${o}`,t(e)}),(e=>{console.log(e),t("none")}))})):"none"}(),"none"===this.coords){if(!document.querySelector(".modal")){const t=function(){const e=document.createElement("div");return e.className="modal",e.innerHTML='<h3 class="modal-header">Something went wrong</h3>\n    <p class="modal-message">Please let us get your coordinates</p>\n    <p class="modal-message">Latitude and longitude, separated by comma</p>\n    <input type"text" class="modal-input">\n    <div class="modal-buttons">\n      <button class="modal-ok button" type="button">Ok</button>\n      <button class="modal-cancel button" type="button">Отмена</button>\n    </div>',e}();document.body.appendChild(t);const n=t.querySelector(".modal-ok"),s=t.querySelector(".modal-cancel"),o=t.querySelector(".modal-input");n.addEventListener("click",(()=>{-1!==o.value.search(/^(\[?-?)((\d|[0-8]\d?|90)\.\d{4,}), ?(-|−)?((\d|\d\d|1[0-7][0-9]|180)\.\d{4,})(\]?)$/)?(this.coords=o.value,this.addMessage(e,this.coords),t.parentNode.removeChild(t)):alert("Введите корректные координаты")})),s.addEventListener("click",(()=>{t.parentNode.removeChild(t)}))}}else this.addMessage(e,this.coords)}addMessage(t,n){const s=document.createElement("div");s.className="message",s.innerHTML=`<div class='message-item'>\n        <p class="message-text">${t}</p>\n        <div class="message-coordinates">${n}</div>\n        </div>\n        <div class="message-date">${function(){const t=new Date;return`${e(t.getDate())}.${e(t.getMonth()+1)}.${e(t.getFullYear())} ${e(t.getHours())}:${e(t.getMinutes())}`}()}</div>`,this.messages.insertAdjacentElement("afterbegin",s)}},n=document.querySelector(".input-content");let s=null;n.addEventListener("keypress",(e=>{"Enter"===e.key&&(s=n.value,t.newMessage(s),n.value="")}))}();